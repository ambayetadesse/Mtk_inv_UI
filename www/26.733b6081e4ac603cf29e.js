(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"7mbe":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var c=n("HDdC"),o=(n("S7rW"),n("4XzM"),n("EUDy"),n("Drjo"),n("XEKg")),i=n("5Jak"),r=n("/GcI"),a=n("cxbk"),s=n("fXoL"),l=n("tk/3"),u=function(){function e(e){this.http=e,this.APIURL=a.a.apiURL}return e.prototype.create=function(e){return this.http.post(this.APIURL+"/vocher",e).catch(this.handleError)},e.prototype.getVoucherVendorId=function(){return this.http.get(this.APIURL+"/vocher")},e.prototype.getAllVocher=function(){return this.http.get(this.APIURL+"/vocher")},e.prototype.updateVocher=function(e){return this.http.put(this.APIURL+"/vocher",e).catch(this.handleError)},e.prototype.addVocher=function(e){return this.http.post(this.APIURL+"/vocher",e).catch(this.handleError)},e.prototype.removeVocher=function(e){return this.http.delete(this.APIURL+"/vocher/"+e).catch(this.handleError)},e.prototype.handleError=function(e){return c.a.throw(400===e.status?new o.a(e.json()):404===e.status?new i.a:new r.a(e))},e.\u0275fac=function(t){return new(t||e)(s.kc(l.a))},e.\u0275prov=s.Ub({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},malj:function(e,t,n){"use strict";n.r(t),n.d(t,"RecievePaymentPageModule",function(){return B});var c=n("ofXK"),o=n("3Pt+"),i=n("TEn/"),r=n("/ZIY"),a=n("PVOt"),s=n("4Ewp"),l=n("ZzPI"),u=n("Gkpw"),d=n("WYlB"),h=n("tyNb"),p=n("mrSG"),f=n("fXoL"),m=n("GIHS"),b=n("7mbe"),g=n("6t9p"),v=["pageTop"];function y(e,t){if(1&e&&(f.dc(0,"div"),f.dc(1,"div",30),f.dc(2,"div"),f.Oc(3),f.cc(),f.cc(),f.cc()),2&e){var n=t.$implicit;f.Mb(3),f.Rc("",n.fullname," ",n.phonenumber,"")}}function w(e,t){1&e&&(f.dc(0,"small",31),f.Oc(1," This field is required! "),f.cc())}var C=function(){return["id","fullname","contact","phonenumber","address"]},x=function(e,t){return{"location-visible":e,"location-hidden":t}},O=[{path:"",component:function(){function e(e,t,n,c){this.fb=e,this.customerService=t,this.alertController=n,this.voucherService=c,this.regform=this.fb.group({}),this.payment=0,this.checkedItems=[],this.selectAllModeVlaue="page",this.selectionModeValue="all",this.arr_names=new Array,this.selectedItemKeys=[],this.showScroll=!1,this.fields={text:"phonenumber",value:"fullname"},this.watermark2="Select Customer",this.height="250px",this.allMode="allPages",this.checkBoxesMode="onClick"}return e.prototype.pageScroller=function(){this.pageTop.scrollToTop()},e.prototype.ngOnInit=function(){return Object(p.a)(this,void 0,void 0,function(){return Object(p.c)(this,function(e){return this.regform=this.fb.group({customer:["",o.s.required],payment:["",o.s.required],updateBalance:0}),this.getAllCustomerList(),[2]})})},e.prototype.onChange=function(e){var t=this;this.checkedItems.includes(e)?this.checkedItems=this.checkedItems.filter(function(t){return t!=e}):this.checkedItems.push(e),this.payment=0,this.PaidBalance=0,this.checkedItems.forEach(function(e){t.payment=+t.payment+e.subTotal,t.PaidBalance=t.payment,t.remaining=t.totalBalance-t.PaidBalance})},e.prototype.scroll=function(e){this.showScroll=e.detail.scrollTop>300},e.prototype.getDisplayExpr=function(e){return e?e.fullname+" "+e.phonenumber:""},e.prototype.getAllCustomerList=function(){return Object(p.a)(this,void 0,void 0,function(){var e=this;return Object(p.c)(this,function(t){return this.customerService.getAllCustomer().subscribe(function(t){return Object(p.a)(e,void 0,void 0,function(){var e,n=this;return Object(p.c)(this,function(c){switch(c.label){case 0:return[4,t.length];case 1:return c.sent()>0?(e=this,[4,t]):[3,3];case 2:return e.listOfCustomer=c.sent(),this.defaultSelectedCurrency=this.listOfCustomer[0].id,this.customerId=this.defaultSelectedCurrency,null!==this.customerId&&this.voucherService.getAllVocher().subscribe(function(e){return Object(p.a)(n,void 0,void 0,function(){var t,n=this;return Object(p.c)(this,function(c){switch(c.label){case 0:return t=this,[4,e.filter(function(e){return e.userId==n.customerId&&"Unpaid"==e.paymentStatus})];case 1:return t.listOfVoucher=c.sent(),[2]}})})}),[3,4];case 3:this.AlertInternet(),c.label=4;case 4:return[2]}})})},function(t){return Object(p.a)(e,void 0,void 0,function(){return Object(p.c)(this,function(e){switch(e.label){case 0:return[4,this.loader.dismiss().then()];case 1:return e.sent(),console.log(t),[2]}})})}),[2]})})},e.prototype.getVoucherById=function(e){return Object(p.a)(this,void 0,void 0,function(){var t=this;return Object(p.c)(this,function(n){return this.totalBalance=0,this.balance=0,null!==this.customerId&&this.voucherService.getAllVocher().subscribe(function(n){return Object(p.a)(t,void 0,void 0,function(){var t,c=this;return Object(p.c)(this,function(o){switch(o.label){case 0:return t=this,[4,n.filter(function(t){return t.userId==e&&"Unpaid"==t.paymentStatus})];case 1:return t.listOfVoucher=o.sent(),0==this.listOfVoucher.length?this.balance=this.updateBalance:this.listOfVoucher.forEach(function(e){c.totalBalance=+c.totalBalance+e.subTotal,c.balance=c.totalBalance+c.updateBalance}),console.log(n),[2]}})})},function(e){return Object(p.a)(t,void 0,void 0,function(){return Object(p.c)(this,function(t){switch(t.label){case 0:return[4,this.loader.dismiss().then()];case 1:return t.sent(),console.log(e),[2]}})})}),[2]})})},e.prototype.onKey=function(){this.Balance=this.updateBalance+this.totalBalance-this.regform.get("payment").value},e.prototype.SelectedValue=function(e){var t=this;this.id=e.value||e.previousValue,this.filterCustomer=this.listOfCustomer.filter(function(e){return e.id==t.id}),this.selectedCustomerBalance=this.filterCustomer[0].balance,this.payment=0,this.checkedItems.splice(0),this.updateBalance=this.selectedCustomerBalance,this.customerId=this.filterCustomer[0].id,this.getVoucherById(this.customerId)},e.prototype.reCalculateBalance=function(){var e=this;if(this.regform.valid){if(!this.recieveBalanceId){var t={id:this.defaultSelectedCurrency,fullname:this.filterCustomer[0].fullname,phonenumber:this.filterCustomer[0].phonenumber,location:this.filterCustomer[0].location,balance:this.updateBalance-this.payment,address:this.filterCustomer[0].address};this.checkedItems.forEach(function(t){t.forEach(function(t){e.voucherService.updateVocher({id:t.id,vocherId:t.vocherId,subTotal:t.subTotal,taxAmount:t.taxAmount,grandTotal:t.grandTotal,date:t.date,vocherTypeId:t.vocherTypeId,vendor:t.vendor,userId:t.userId,PaymentStatus:"paid"}).subscribe(function(){console.log("update success"),e.getAllCustomerList()})})}),this.customerService.updateCustomer(t).subscribe(function(){return console.log("update success")})}this.regform.reset(),this.recieveBalanceId="",this.presentAlert(" Sucess")}else this.presentAlert("Please enter all fields")},e.prototype.presentAlert=function(e){return Object(p.a)(this,void 0,void 0,function(){return Object(p.c)(this,function(t){switch(t.label){case 0:return[4,this.alertController.create({cssClass:"my-custom-class",header:"Recive payment",message:e,buttons:["OK"]})];case 1:return[4,t.sent().present()];case 2:return t.sent(),[2]}})})},e.prototype.selectionChangedHandler=function(e){var t=this;this.checkedItems=[];var n=e.selectedRowsData;this.checkedItems.includes(n)?this.checkedItems=this.checkedItems.filter(function(e){return e!=n}):(this.checkedItems.push(n),this.selectedRows.push(e.selectedRowKeys)),this.payment=0,this.PaidBalance=0,this.checkedItems.forEach(function(e){e.forEach(function(e){t.payment=+t.payment+e.subTotal,t.PaidBalance=t.payment,t.remaining=t.totalBalance-t.PaidBalance})})},e.prototype.payAllBalance=function(){var e=this;this.listOfVoucher.forEach(function(t){e.payment=+e.payment+t.subTotal,e.PaidBalance=e.payment,e.remaining=e.totalBalance-e.PaidBalance})},e.prototype.selectionChangedRow=function(e){this.selectedItemKeys=e.selectedRowKeys},e.prototype.AlertInternet=function(){return Object(p.a)(this,void 0,void 0,function(){return Object(p.c)(this,function(e){switch(e.label){case 0:return[4,this.alertController.create({cssClass:"my-custom-class",header:"Internet",message:"Please turn on wifi or data",buttons:["OK"]})];case 1:return[4,e.sent().present()];case 2:return e.sent(),[2]}})})},e.\u0275fac=function(t){return new(t||e)(f.Yb(o.c),f.Yb(m.a),f.Yb(i.a),f.Yb(b.a))},e.\u0275cmp=f.Sb({type:e,selectors:[["app-recieve-payment"]],viewQuery:function(e,t){var n;1&e&&f.Tc(v,1),2&e&&f.Dc(n=f.pc())&&(t.pageTop=n.first)},decls:52,vars:36,consts:[[3,"translucent"],["color","primary"],["slot","start"],["scrollEvents","true",3,"ionScroll"],["pageTop",""],[3,"formGroup"],["lines","full"],[1,"dx-field"],["valueExpr","id","placeholder","Select Items","formControlName","customer","itemTemplate","listOfCustomer",3,"items","searchExpr","displayExpr","ngModel","onValueChanged","ngModelChange"],["title","Select Customers"],[4,"dxTemplate","dxTemplateOf"],["formControlName","updateBalance","readonly","",3,"ngModel","value","ngModelChange"],["type","number","formControlName","payment","aria-placeholder","Enter payment",3,"ngModel","ngModelChange","keyup"],["class","form-text text-muted",4,"ngIf"],[2,"text-align","center","margin","auto"],["id","add items",3,"disabled","click"],["slot","start","name","add-circle-outline"],["text","Clear Selection",3,"disabled","onClick"],["id","grid-container","keyExpr","id",3,"dataSource","showRowLines","showBorders","remoteOperations","columnAutoWidth","selectedRowKeys","selectedRowKeysChange","onSelectionChanged"],["grid",""],["mode","multiple",3,"selectAllMode","showCheckBoxesMode"],[3,"pageSize"],["dataField","vocherId","caption","vocherId",3,"width"],["dataField","date","height","80%","width","100px"],["dataField","grandTotal",3,"width"],["dataField","subTotal",3,"width"],["expand","block",3,"disabled","click"],["horizontal","end","vertical","bottom","slot","fixed",3,"ngClass"],["color","light",3,"click"],["md","chevron-up-outline","ios","chevron-up-circle-outline"],[1,"custom-item"],[1,"form-text","text-muted"]],template:function(e,t){if(1&e){var n=f.ec();f.dc(0,"ion-header",0),f.dc(1,"ion-toolbar",1),f.dc(2,"ion-buttons",2),f.Zb(3,"ion-menu-button"),f.cc(),f.dc(4,"ion-title"),f.Oc(5,"Recieve payment"),f.cc(),f.cc(),f.cc(),f.dc(6,"ion-content",3,4),f.oc("ionScroll",function(e){return t.scroll(e)}),f.dc(8,"form",5),f.dc(9,"ion-item",6),f.dc(10,"ion-label"),f.Oc(11," Select Customer"),f.cc(),f.dc(12,"div",7),f.dc(13,"dx-lookup",8),f.oc("onValueChanged",function(e){return t.SelectedValue(e)})("ngModelChange",function(e){return t.defaultSelectedCurrency=e}),f.Zb(14,"dxo-drop-down-options",9),f.Mc(15,y,4,2,"div",10),f.cc(),f.cc(),f.cc(),f.dc(16,"ion-item"),f.dc(17,"ion-label"),f.Oc(18,"Balance "),f.cc(),f.dc(19,"ion-input",11),f.oc("ngModelChange",function(e){return t.updateBalance=e}),f.cc(),f.cc(),f.dc(20,"ion-item"),f.dc(21,"ion-label"),f.Oc(22,"Payment "),f.cc(),f.dc(23,"ion-input",12),f.oc("ngModelChange",function(e){return t.payment=e})("keyup",function(){return t.onKey()}),f.cc(),f.Mc(24,w,2,0,"small",13),f.cc(),f.dc(25,"div",14),f.dc(26,"ion-button",15),f.oc("click",function(){return t.reCalculateBalance()}),f.Zb(27,"ion-icon",16),f.Oc(28,"Calculate Balance "),f.cc(),f.cc(),f.dc(29,"div"),f.dc(30,"dx-button",17),f.oc("onClick",function(){return f.Fc(n),f.Ec(32).instance.clearSelection()}),f.cc(),f.dc(31,"dx-data-grid",18,19),f.oc("selectedRowKeysChange",function(e){return t.selectedRows=e})("onSelectionChanged",function(e){return t.selectionChangedRow(e)})("onSelectionChanged",function(e){return t.selectionChangedHandler(e)}),f.Zb(33,"dxo-selection",20),f.Zb(34,"dxo-paging",21),f.Zb(35,"dxi-column",22),f.Zb(36,"dxi-column",23),f.Zb(37,"dxi-column",24),f.Zb(38,"dxi-column",25),f.cc(),f.dc(39,"ion-item"),f.dc(40,"ion-label"),f.Oc(41,"Remining"),f.cc(),f.Oc(42),f.cc(),f.dc(43,"ion-item"),f.dc(44,"ion-label"),f.Oc(45,"Total Paid"),f.cc(),f.Oc(46),f.cc(),f.dc(47,"ion-button",26),f.oc("click",function(){return t.payAllBalance()}),f.Oc(48,"Pay Balance"),f.cc(),f.cc(),f.cc(),f.dc(49,"ion-fab",27),f.dc(50,"ion-fab-button",28),f.oc("click",function(){return t.pageScroller()}),f.Zb(51,"ion-icon",29),f.cc(),f.cc(),f.cc()}2&e&&(f.wc("translucent",!0),f.Mb(8),f.wc("formGroup",t.regform),f.Mb(5),f.wc("items",t.listOfCustomer)("searchExpr",f.zc(32,C))("displayExpr",t.getDisplayExpr)("ngModel",t.defaultSelectedCurrency),f.Mb(2),f.wc("dxTemplateOf","listOfCustomer"),f.Mb(4),f.xc("value",t.updateBalance),f.wc("ngModel",t.updateBalance),f.Mb(4),f.wc("ngModel",t.payment),f.Mb(1),f.wc("ngIf",!t.regform.get("payment").valid&&t.regform.get("payment").touched),f.Mb(2),f.wc("disabled",!t.regform.valid),f.Mb(4),f.wc("disabled",!(null!=t.selectedRows&&t.selectedRows.length)),f.Mb(1),f.wc("dataSource",t.listOfVoucher)("showRowLines",!0)("showBorders",!0)("remoteOperations",!0)("columnAutoWidth",!0)("showBorders",!0)("showRowLines",!0)("selectedRowKeys",t.selectedRows)("showBorders",!0),f.Mb(2),f.wc("selectAllMode",t.allMode)("showCheckBoxesMode",t.checkBoxesMode),f.Mb(1),f.wc("pageSize",10),f.Mb(1),f.wc("width",90),f.Mb(2),f.wc("width",80),f.Mb(1),f.wc("width",80),f.Mb(4),f.Qc(" ",t.remaining," "),f.Mb(4),f.Qc(" ",t.PaidBalance," "),f.Mb(1),f.wc("disabled",t.payment>=1),f.Mb(2),f.wc("ngClass",f.Bc(33,x,t.showScroll,!t.showScroll)))},directives:[i.s,i.V,i.f,i.E,i.U,i.m,o.t,o.l,o.f,i.w,i.A,r.a,o.k,o.d,g.nc,a.e,i.v,i.hb,i.bb,c.l,i.e,i.t,d.a,l.a,g.ne,g.Qd,g.k,i.o,c.j,i.p],styles:["ion-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{padding:0;--border-radius:14px}.location-visible[_ngcontent-%COMP%]{opacity:1;transition:.5s}.location-hidden[_ngcontent-%COMP%]{opacity:0;transition:.5s}  .field-customization{min-height:32px}  .dx-lookup.field-customization .dx-lookup-field{padding:0 5px}  .custom-field>img{vertical-align:middle;height:30px;width:21px}  .custom-field>div{display:inline-block;vertical-align:middle;line-height:30px;font-size:14px;margin-left:5px}  .custom-item>img{height:48px;width:38px;margin-right:10px}  .custom-item>div{display:inline-block;vertical-align:top;line-height:48px;font-size:15px}  .dx-viewport:not(.dx-theme-ios7) .dx-fieldset{width:40%;float:left}  .dx-field>.dx-lookup{flex:1}.table[_ngcontent-%COMP%]{border-radius:6px;background-color:#e9ecef}"]}),e}()}],I=function(){function e(){}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f.Wb({type:e}),e.\u0275inj=f.Vb({imports:[[h.j.forChild(O)],h.j]}),e}(),B=function(){function e(){}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f.Wb({type:e}),e.\u0275inj=f.Vb({imports:[[c.b,o.g,i.W,o.q,r.b,a.g,I,s.b,l.b,u.b,d.b]]}),e}()}}]);